e_charge = 1.60217662e-19 - –∑–∞—Ä—è–¥ –∑–ª–µ–∫—Ç—Ä–æ–Ω–∞  -1,602176634 * 10^19 [–ö–ª]

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±–µ—Ä–µ–º –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã—Ö –≤–∏—á–∏—Å–ª–µ–Ω–∏–π –∏ –Ω–∞–≥–ª—è–¥–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤

m_electron = 9.10938356e-31  - –º–∞—Å—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ [–ö–≥]

mu_0 = 4 * np.pi * 1e-7  - –º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å –≤–∞–∫—É—É–º–∞ [–ì–Ω/–º]

---

````
def electron_motion(y, t, U, B, m, e):
    x, y, vx, vy = y
    dvxdt = (e / m) * vy * B
    dvydt = -(e / m) * vx * B - (e / m) * U * vy / np.sqrt(vx ** 2 + vy ** 2)
    return [vx, vy, dvxdt, dvydt]
````

1) sol = odeint(electron_motion, [x0, y0, v0, 0], t, args=(U, B, m_electron, e_charge))

       x, y, vx, vy = y y - [x0, y0, v0, 0]


2) dvxdt = (e / m) * vy * B  - —ç—Ç–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–æ—Ä–µ–Ω—Ü–∞, –∫–æ—Ç–æ—Ä–æ–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–∏–ª—É, –¥–µ–π—Å—Ç–≤—É—é—â—É—é –Ω–∞ –∑–∞—Ä—è–∂–µ–Ω–Ω—É—é —á–∞—Å—Ç–∏—Ü—É, –¥–≤–∏–∂—É—â—É—é—Å—è –≤ –º–∞–≥–Ω–∏—Ç–Ω–æ–º –ø–æ–ª–µ. 
    
       F_–ª–æ—Ä–µ–Ω—Ü–∞ = q * v * B * sin(a), q - –∑–∞—Ä—è–¥, v - —Å–∫–æ—Ä–æ—Å—Ç—å, B –≤–µ–∫—Ç–æ—Ä –º–∞–≥–Ω–∏—Ç–Ω–æ–π –∏–Ω–¥—É–∫—Ü–∏–∏, –∞ - —É–ª–æ–≥ –º–µ–∂–¥—É v –∏ B. –£ –Ω–∞—Å sin(a) = 1.
    
       –ü–æ 2 –ó.–ù. ‚àëF = ma, F = ma, F = q v B sin(a) => ma = q v B sin(a) => a = q/m v B sin(a), –∫–æ—Ç–æ—Ä—ã–π —É –Ω–∞—Å 1, —Ç–∫ V | B.  


3) dvydt = -(e / m) * vx * B - (e / m) * U * vy / np.sqrt(vx ** 2 + vy ** 2) 

       –ú–∏–Ω—É—Å—ã —Ç—É—Ç - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø–æ –ø–æ–≤–æ–¥—É –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ: (e / m) * vx * B - –Ω—É —ç—Ç–æ —É–∂–µ –ø–æ–Ω—è—Ç–Ω–æ –∏–∑ –ø.2. 

       –ê (e / m) * U * vy / np.sqrt(vx ** 2 + vy ** 2) –∫–∞–∫ —è –ø–æ–Ω –∏–¥–µ—Ç –∏–∑ E = F/q –∏ qEd = qU.

       F = ma (II –ó.–ù),
       F = Eq, F = ma => ma = Eq => a = (q/m)E ==(E = U/d)> a = (q/m)U/d, 

       –∫–∞–∫ —è –ø–æ–Ω –ø–æ –ü–∏—Ñ–∞–≥–æ—Ä—É –Ω–∞—à–ª–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ d => (np.sqrt(vx ** 2 + vy ** 2)) => (e / m) * U / np.sqrt(vx ** 2 + vy ** 2). vy —Ç—É—Ç —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å (–≤—ã–≤–æ–¥—è —ç—Ç–æ —Ä—É–∫–∞–º–∏ —è –Ω–µ —Å–º–æ–≥ –Ω–∞–π—Ç–∏ —á—Ç–æ-—Ç–æ —Å v).

---

````
def orbit_radius(I, U, n):
    B = mu_0 * n * I

    if B == 0:
        return

    return math.sqrt((m_electron * 2 * U)/(e_charge * (B ** 2)))
````

1) B = mu_0 * n * I 
    
       B - –º–∞–≥–Ω–∏—Ç–Ω–æ–µ –ø–æ–ª–µ –≤–Ω—É—Ç—Ä–∏ —Å–æ–ª–µ–Ω–æ–∏–¥–∞,
    
       mu_0 - –º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å –≤–∞–∫—É—É–º–∞,

       n - —á–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã —Å–æ–ª–µ–Ω–æ–∏–¥–∞,
   
       I - —Ç–æ–∫ —á–µ—Ä–µ–∑ —Å–æ–ª–µ–Ω–æ–∏–¥.

    –≠—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞ 

    <p align="center">
    <img width="382" src="images/B.png" alt="qr"/>
    </p>

    [—Ñ–æ—Ä–º—É–ª–∞ —Å–æ studfile](https://studfile.net/preview/2953066/page:5/)

2) math.sqrt((m_electron * 2 * U)/(e_charge * (B ** 2)))
     
   —É—Ñ, –Ω—É –ø–æ–µ—Ö–∞–ª–∏

          F_—Ü–µ–Ω—Ç—Ä–æ–±–µ–∂–Ω–∞—è = m w^2 r, –≥–¥–µ
          m - –º–∞—Å—Å–∞,
          w (–æ–º–µ–≥–∞) - —É–≥–ª–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å,
          r - —Ä–∞–¥–∏—É—Å.

   F_–ª–æ—Ä–µ–Ω—Ü–∞ (–±—ã–ª–∞ –≤—ã—à–µ) = qvBsin(a) 
   
   ### –≤—ã–≤–æ–¥

           F_—Ü = F_–ª
        
           –ö–æ–≥–¥–∞ –∑–∞—Ä—è–∂–µ–Ω–Ω–∞—è —á–∞—Å—Ç–∏—Ü–∞ –¥–≤–∏–∂–µ—Ç—Å—è –≤ –º–∞–≥–Ω–∏—Ç–Ω–æ–º –ø–æ–ª–µ, –Ω–∞ –Ω–µ–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–∏–ª–∞ –õ–æ—Ä–µ–Ω—Ü–∞.
           –ï—Å–ª–∏ —á–∞—Å—Ç–∏—Ü–∞ –¥–≤–∏–∂–µ—Ç—Å—è –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ –º–∞–≥–Ω–∏—Ç–Ω–æ–º—É –ø–æ–ª—é, —ç—Ç–∞ —Å–∏–ª–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–æ–±–µ–∂–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ, –∏ —á–∞—Å—Ç–∏—Ü–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –∫—Ä—É–≥–æ–≤–æ–π –æ—Ä–±–∏—Ç–µ.

           mw^2r = qvBsin(a)                           (sin(a) = 1, v = wr => w = v/r)

           m (v/r)^2 r = qvB                           ((v/r)^2 * r/v = v/r)

           m v/r = qB                                  (—É–º–Ω–æ–∂–∞–µ–º –Ω–∞ r –¥–µ–ª–∏–º –Ω–∞ qB)

           mv/qB = r                                   (v = sqrt( 2 * e/m * U), q = e)

           m * sqrt(2 *  e/m * U) / e B = r            (m = sqrt(m^2) –∏ —Ç–¥)

           sqrt(m^2 * 2 * e/m * U / (e^2 * B^2)) = r   (—Å–æ–∫—Ä–∞—â–∞–µ–º m –∏ e)

           sqrt(m * 2 * U / (e * B^2)) = r

   ##### –±—É–∫–û–≤—ã:
          
           F_—Ü - —Ü–µ–Ω—Ç—Ä–æ–±–µ–∂–Ω–∞—è —Å–∏–ª–∞ [–ù],
           m - –º–∞—Å—Å–∞ [–ö–≥],
           w (–æ–º–µ–≥–∞) - —É–≥–ª–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å [—Ä–∞–¥/—Å],
           r - —Ä–∞–¥–∏—É—Å [–º],
           F_–ª - —Å–∏–ª–∞ –õ–æ—Ä–µ–Ω—Ü–∞ [H],
           B - –≤–µ–∫—Ç–æ—Ä –º–∞–≥–Ω–∏—Ç–Ω–æ–π –∏–Ω–¥—É–∫—Ü–∏–∏ [–¢–ª],
           q - –∑–∞—Ä—è–¥ [–ö–ª],
           v - —Å–∫–æ—Ä–æ—Å—Ç—å [–º/—Å],
           e - –∑–∞—Ä—è–¥ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ [–ö–ª],
           U - –Ω–∞–ø—Ä—è–¥–µ–Ω–∏–µ [–í].

   ##### —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è v

    <p align="center">
    <img width="382" src="images/v.png" alt="qr"/>
    </p>

   [—Ñ–æ—Ä–º—É–ª–∞ —Å–æ studfile](https://studfile.net/preview/1644348/)
---

````
def simulate_and_plot(U, Ic, Rk, steps=1000, tmax=1e-6, stop_velocity=None):
    n = 100  # –ß–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã
    B = mu_0 * n * Ic  # –ú–∞–≥–Ω–∏—Ç–Ω–æ–µ –ø–æ–ª–µ –≤–Ω—É—Ç—Ä–∏ —Å–æ–ª–µ–Ω–æ–∏–¥–∞

    # –ù–∞—á–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
    x0 = Rk
    y0 = 0
    v0 = np.sqrt(2 * e_charge * U / m_electron)
    r_orbit = orbit_radius(Ic, U, n)  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–¥–∏—É—Å–∞ –æ—Ä–±–∏—Ç—ã

    # –£–≥–ª–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞
    omega = v0 / r_orbit

    # –í—Ä–µ–º–µ–Ω–Ω–æ–π –º–∞—Å—Å–∏–≤
    t = np.linspace(0, tmax, steps)

    # –†–µ—à–µ–Ω–∏–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π
    sol = odeint(electron_motion, [x0, y0, v0, 0], t, args=(U, B, m_electron, e_charge))

    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
    if stop_velocity is not None:
        idx = np.where(np.sqrt(sol[:, 2] ** 2 + sol[:, 3] ** 2) <= stop_velocity)[0]
        if len(idx) > 0:
            sol = sol[:idx[0] + 1]

    # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
    plt.figure(figsize=(8, 6))
    plt.plot(sol[:, 0], sol[:, 1])
    plt.xlabel('x')
    plt.ylabel('y')
    plt.title('–¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞')
    plt.gca().set_aspect('equal', adjustable='box')
    plt.grid(True)
    plt.show()

    return r_orbit
````

1) n = 100  - –ß–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã, B = mu_0 * n * Ic  - –ú–∞–≥–Ω–∏—Ç–Ω–æ–µ –ø–æ–ª–µ –≤–Ω—É—Ç—Ä–∏ —Å–æ–ª–µ–Ω–æ–∏–¥–∞ (–±—ã–ª–æ —Ä–∞–∑–æ–±—Ä–∞–Ω–æ –≤ –ø—Ä–æ—à–ª–æ–º –ø—É–Ω–∫—Ç–µ)

2)  x0 = Rk, y0 = 0, v0 = np.sqrt(2 * e_charge * U / m_electron), r_orbit = orbit_radius(Ic, U, n)
   
   x0 = Rk    (Rk - —Ä–∞–¥–∏—É—Å –∫–∞—Ç–æ–¥–∞)

         –≠—Ç–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –ø–æ –æ—Å–∏ x.
         –≠–ª–µ–∫—Ç—Ä–æ–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∏–∑ –∫–∞—Ç–æ–¥–∞, –ø–æ—ç—Ç–æ–º—É –µ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –æ—Å–∏ x —Ä–∞–≤–Ω–æ —Ä–∞–¥–∏—É—Å—É –∫–∞—Ç–æ–¥–∞

   y0 = 0
         
         –≠—Ç–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –ø–æ –æ—Å–∏ y.
         –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –≤ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ x-y, –º—ã –º–æ–∂–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∏–∑ —Ç–æ—á–∫–∏ (Rk, 0)

   v0 = np.sqrt(2 * e_charge * U / m_electron)

         –≠—Ç–æ –Ω–∞—á–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞.
   <p align="center">
    <img width="382" src="images/v.png" alt="qr"/>
    </p>

   [—Ñ–æ—Ä–º—É–ª–∞ —Å–æ studfile](https://studfile.net/preview/1644348/)

   r_orbit = orbit_radius(Ic, U, n)

         –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–¥–∏—É—Å–∞ –æ—Ä–±–∏—Ç—ã —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞.
         –¢—É—Ç Ic - —Ç–æ–∫ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ [A], U - —Ä–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤/–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ [B], n - —á–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã.

3) omega = v0 / r_orbit

   –≤–æ—Ç —Ñ–æ—Ä–º—É–ª–∞: 

   <p align="center">
    <img width="382" src="images/w.png" alt="qr"/>
    </p>

   –ü—Ä–æ—Å—Ç–æ –¥–µ–ª–∏–º —ç—Ç–æ –Ω–∞ R

4) t = np.linspace(0, tmax, steps), sol = odeint(electron_motion, [x0, y0, v0, 0], t, args=(U, B, m_electron, e_charge))

   t = np.linspace(0, tmax, steps)

         –≠—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.
         –§—É–Ω–∫—Ü–∏—è np.linspace –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ numpy –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ.
         –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –æ–Ω–∞ —Å–æ–∑–¥–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –æ—Ç 0 –¥–æ tmax –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ steps —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
         –≠—Ç–æ—Ç –º–∞—Å—Å–∏–≤ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ tmax.

   sol = odeint(electron_motion, [x0, y0, v0, 0], t, args=(U, B, m_electron, e_charge))

         –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞.
         –§—É–Ω–∫—Ü–∏—è odeint –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ scipy.integrate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π (ODE).
         –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É ODE, –∑–∞–¥–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–µ–π electron_motion, —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ [x0, y0, v0, 0] –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º t.
         –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ electron_motion –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä args.
         –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ odeint —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ sol, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è x, y, vx, vy –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

5) –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ 

   ````
       if stop_velocity is not None:
        idx = np.where(np.sqrt(sol[:, 2] ** 2 + sol[:, 3] ** 2) <= stop_velocity)[0]
   
        if len(idx) > 0:
            sol = sol[:idx[0] + 1]
   ````
   
        if stop_velocity is not None:

        –≠—Ç–æ —É—Å–ª–æ–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–¥–∞–Ω–æ –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è stop_velocity.
        –ï—Å–ª–∏ stop_velocity –Ω–µ —Ä–∞–≤–Ω–æ None, —Ç–æ –∫–æ–¥ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ —É—Å–ª–æ–≤–Ω–æ–≥–æ –±–ª–æ–∫–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω.

        idx = np.where(np.sqrt(sol[:, 2] ** 2 + sol[:, 3] ** 2) <= stop_velocity)[0]:
        –≠—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é np.where –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ numpy –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç –∑–∞–¥–∞–Ω–Ω–æ–º—É —É—Å–ª–æ–≤–∏—é. 
        
        –ì–¥–µ sol[:, 2] –∏ sol[:, 3] - —ç—Ç–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –ø–æ –æ—Å–∏ x –∏ y —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.
        –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, idx - —ç—Ç–æ –∏–Ω–¥–µ–∫—Å –ø–µ—Ä–≤–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–≥–¥–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ–π stop_velocity. 

        if len(idx) > 0:: –≠—Ç–æ –µ—â–µ –æ–¥–Ω–æ —É—Å–ª–æ–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–∞–π–¥–µ–Ω –ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–≥–¥–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ–π stop_velocity.

        sol = sol[:idx[0] + 1]: –ï—Å–ª–∏ —Ç–∞–∫–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–π–¥–µ–Ω, —Ç–æ –º–∞—Å—Å–∏–≤ sol –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ).
        –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è sol, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–æ–º–µ–Ω—Ç–∞–º –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–≥–¥–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –º–µ–Ω—å—à–µ stop_velocity, –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

        –í –æ–±—â–µ–º, —ç—Ç–æ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞, –∫–æ–≥–¥–∞ –µ–≥–æ —Å–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è stop_velocity.
        –¢—É—Ç —ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, –µ—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ–π –∏ –µ–≥–æ –¥–∞–ª—å–Ω–µ–π—à–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞.

6) –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–Ω–∞ –≤—Å—è–∫–∏–π)

   ````
   plt.figure(figsize=(8, 6))
    plt.plot(sol[:, 0], sol[:, 1])
    plt.xlabel('x')
    plt.ylabel('y')
    plt.title('–¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞')
    plt.gca().set_aspect('equal', adjustable='box')
    plt.grid(True)
    plt.show()

    return r_orbit
   ````
   
       plt.figure(figsize=(8, 6)): –≠—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–∏–≥—É—Ä—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º.
       –§—É–Ω–∫—Ü–∏—è plt.figure –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ matplotlib.pyplot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Ñ–∏–≥—É—Ä—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞.
       –ü–∞—Ä–∞–º–µ—Ç—Ä figsize –∑–∞–¥–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã –≤ –¥—é–π–º–∞—Ö.

       plt.plot(sol[:, 0], sol[:, 1]): –≠—Ç–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞.
       –§—É–Ω–∫—Ü–∏—è plt.plot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞. sol[:, 0] –∏ sol[:, 1] - —ç—Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã x –∏ y —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

       plt.xlabel('x') –∏ plt.ylabel('y'): –≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π –≥—Ä–∞—Ñ–∏–∫–∞.
       –§—É–Ω–∫—Ü–∏–∏ plt.xlabel –∏ plt.ylabel –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π x –∏ y —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

       plt.title('–¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞'): –≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞.
       –§—É–Ω–∫—Ü–∏—è plt.title –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞.

       plt.gca().set_aspect('equal', adjustable='box'): –≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–≤–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ –æ—Å–µ–π x –∏ y, —á—Ç–æ–±—ã –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ –≤—ã–≥–ª—è–¥–µ–ª–∏ –∫–∞–∫ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –∫–∞–∫ —ç–ª–ª–∏–ø—Å—ã.
       –§—É–Ω–∫—Ü–∏—è plt.gca().set_aspect –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞—Å–ø–µ–∫—Ç–∞ —Ç–µ–∫—É—â–∏—Ö –æ—Å–µ–π.

       plt.grid(True): –≠—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫.
       –§—É–Ω–∫—Ü–∏—è plt.grid –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫.

       plt.show(): –≠—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞.
       –§—É–Ω–∫—Ü–∏—è plt.show –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞.
       –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–æ–º–∞–Ω–¥—ã —Ç–æ–ª—å–∫–æ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é—Ç –≥—Ä–∞—Ñ–∏–∫, –∏ –æ–Ω —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

       return r_orbit: –≠—Ç–æ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–∞–¥–∏—É—Å–∞ –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏. –ó–Ω–∞—á–µ–Ω–∏–µ r_orbit, –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –≤ —Ñ—É–Ω–∫—Ü–∏–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏.
---

````
def find_required_current(Ra, Rk, n, U):
    r_orbit = (Ra - Rk) / 2  # –†–∞–¥–∏—É—Å –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏

    if (r_orbit * e_charge * n * mu_0) == 0:
        return

    Ic_required = (m_electron * math.sqrt(2 * (e_charge / m_electron) * U)) / (r_orbit * e_charge * n * mu_0)

    return Ic_required
````

1) r_orbit = (Ra - Rk) / 2

       r_orbit = (Ra - Rk) / 2    (r_orbit - —Ä–∞–¥–∏—É—Å –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ [–º], Ra - —Ä–∞–¥–∏—É—Å –∞–Ω–æ–¥–∞ [–º], Rk - —Ä–∞–¥–∏—É—Å –∫–∞—Ç–æ–¥–∞ [–º])

       –ó–¥–µ—Å—å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ä–∞–¥–∏—É—Å –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞.
       –≠—Ç–æ –ø–æ–ª–æ–≤–∏–Ω–∞ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Ä–∞–¥–∏—É—Å–∞–º–∏ –∞–Ω–æ–¥–∞ –∏ –∫–∞—Ç–æ–¥–∞, —Ç–∞–∫ –∫–∞–∫ —ç–ª–µ–∫—Ç—Ä–æ–Ω –¥–æ–ª–∂–µ–Ω –æ–ø–∏—Å—ã–≤–∞—Ç—å –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk).

2) (r_orbit * e_charge * n * mu_0) == 0

       –≠—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ–ª—å –≤ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ —Å–ª–µ–¥—É—é—â–µ–π —Ñ–æ—Ä–º—É–ª—ã.
       –ï—Å–ª–∏ —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ –Ω—É–ª—é, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å.

3) Ic_required = (m_electron * math.sqrt(2 * (e_charge / m_electron) * U)) / (r_orbit * e_charge * n * mu_0)

       F_—Ü–µ–Ω—Ç—Ä–æ–±–µ–∂–Ω–∞—è = mw^2r
       F_–ª–æ—Ä–µ–Ω—Ü–∞ = qvB
       qvB = mw^2r            (w^2 = v^2/r^2)
       qvB = m v^2/r^2 r      (—Å–æ–∫—Ä–∞—â–∞–µ–º r –∏ v)
       qB = m v/r
       v = rqB/m    =>        (B = mv/rq) (B = mu_0 n I)
       n mu_o I = mv/rq
       I = m v / (r q n mu_o) (q = e, v = sqrt(2 e/m U))
       I = m sqrt(2 e/m U) / (r q n mu_o)
       
       –Ω–æ–≤—ã—Ö –±—É–∫–æ–≤ –Ω–µ—Ç ü§ì.
---

````
def plot_Ic_U_diagram_with_circle(Ra, Rk, n):
    U_values = np.linspace(0, 1000, 100)  # –î–∏–∞–ø–∞–∑–æ–Ω —Ä–∞–∑–Ω–æ—Å—Ç–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤

    # –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π —Å–∏–ª—ã —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ
    Ic_values = []

    for U in U_values:
        # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å–∏–ª—ã —Ç–æ–∫–∞ Ic, —á—Ç–æ–±—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–ª –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk)
        Ic_required = find_required_current(Ra, Rk, n, U)
        Ic_values.append(Ic_required)

    # –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫ —á–∏—Å–ª–æ–≤–æ–º—É —Ç–∏–ø—É
    Ic_values = np.array(Ic_values, dtype=np.float64)

    plt.figure(figsize=(8, 6))
    plt.plot(U_values, Ic_values, label='Ic', color='blue')

    plt.fill_between(U_values, Ic_values, color='red', alpha=0.3, label='–≠–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å (Ra-Rk)')

    plt.xlabel('–†–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ (U)')
    plt.ylabel('–°–∏–ª–∞ —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ (Ic)')
    plt.title('–î–∏–∞–≥—Ä–∞–º–º–∞ Ic –æ—Ç U')
    plt.grid(True)
    plt.legend()
    plt.show()


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
Ra = 0.01  # –†–∞–¥–∏—É—Å –∞–Ω–æ–¥–∞ –≤ –º–µ—Ç—Ä–∞—Ö
Rk = 0.005  # –†–∞–¥–∏—É—Å –∫–∞—Ç–æ–¥–∞ –≤ –º–µ—Ç—Ä–∞—Ö
U = 100  # –†–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ –≤ –≤–æ–ª—å—Ç–∞—Ö
Ic = 1  # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ
n = 100  # –ß–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã

# –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
r_orbit = simulate_and_plot(U, Ic, Rk, stop_velocity=1e5)
print("–†–∞–¥–∏—É—Å –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞:", r_orbit)

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã Ic –æ—Ç U
plot_Ic_U_diagram_with_circle(Ra, Rk, n)
````

    –§—É–Ω–∫—Ü–∏—è plot_Ic_U_diagram_with_circle(Ra, Rk, n) —Å—Ç—Ä–æ–∏—Ç –¥–∏–∞–≥—Ä–∞–º–º—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–∏–ª—ã —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ Ic –æ—Ç —Ä–∞–∑–Ω–æ—Å—Ç–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ U, –∞ —Ç–∞–∫–∂–µ –æ—Ç–º–µ—á–∞–µ—Ç –æ–±–ª–∞—Å—Ç—å, –≥–¥–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk). –í–æ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞:

    U_values = np.linspace(0, 1000, 100):
    –°–æ–∑–¥–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ U_values, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ –æ—Ç 0 –¥–æ 1000. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞.

    Ic_values = []:
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ Ic_values –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Å–∏–ª—ã —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ.

    –í —Ü–∏–∫–ª–µ for U in U_values –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è U –∏–∑ U_values –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Å–∏–ª–∞ —Ç–æ–∫–∞ Ic, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–ª –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk).
    –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ find_required_current(Ra, Rk, n, U), –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Å–∏–ª—É —Ç–æ–∫–∞ Ic.
    –ó–Ω–∞—á–µ–Ω–∏–µ Ic –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ Ic_values.

    Ic_values = np.array(Ic_values, dtype=np.float64):
    –°–ø–∏—Å–æ–∫ Ic_values –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ NumPy –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

    –î–∞–ª–µ–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ —Å —Ä–∞–∑–º–µ—Ä–æ–º (8, 6).
    –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –∫—Ä–∏–≤–∞—è, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å Ic –æ—Ç U (—Å–∏–Ω—è—è –ª–∏–Ω–∏—è).

    –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è plt.fill_between(U_values, Ic_values, color='red', alpha=0.3, label='–≠–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å (Ra-Rk)') –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–∏ –ø–æ–¥ –∫—Ä–∏–≤–æ–π —Å–∏–Ω–µ–π –ª–∏–Ω–∏–∏ –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º. –≠—Ç–∞ –æ–±–ª–∞—Å—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —ç–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk).

    –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∏ –∫ –æ—Å—è–º –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≥—Ä–∞—Ñ–∏–∫–∞, –≤–∫–ª—é—á–∞–µ—Ç—Å—è —Å–µ—Ç–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ª–µ–≥–µ–Ω–¥–∞.

    –í –∫–æ–Ω—Ü–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è plt.show() –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞.

    –í –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è Ra, Rk, U, Ic –∏ n, –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è simulate_and_plot(U, Ic, Rk, stop_velocity=1e5) –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞, –∞ –∑–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è plot_Ic_U_diagram_with_circle(Ra, Rk, n) –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã Ic –æ—Ç U.

````
# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
Ra = 0.01  # –†–∞–¥–∏—É—Å –∞–Ω–æ–¥–∞ –≤ –º–µ—Ç—Ä–∞—Ö
Rk = 0.005  # –†–∞–¥–∏—É—Å –∫–∞—Ç–æ–¥–∞ –≤ –º–µ—Ç—Ä–∞—Ö
U = 100  # –†–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ –≤ –≤–æ–ª—å—Ç–∞—Ö
Ic = 1  # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ
n = 100  # –ß–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã

# –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
r_orbit = simulate_and_plot(U, Ic, Rk, stop_velocity=1e5)
print("–†–∞–¥–∏—É—Å –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞:", r_orbit)

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã Ic –æ—Ç U
plot_Ic_U_diagram_with_circle(Ra, Rk, n)
````

    –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
---

–≤—Å–µ –≤—ã—à–µ–Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —ç—Ç–æ–º—É –∫–æ–¥—É

````
import math

import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

# –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
e_charge = 1.60217662e-19  # —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–π –∑–∞—Ä—è–¥
m_electron = 9.10938356e-31  # –º–∞—Å—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞
mu_0 = 4 * np.pi * 1e-7  # –º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å –≤–∞–∫—É—É–º–∞


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞
def electron_motion(y, t, U, B, m, e):
    x, y, vx, vy = y
    dvxdt = (e / m) * vy * B
    dvydt = -(e / m) * vx * B - (e / m) * U * vy / np.sqrt(vx ** 2 + vy ** 2)

    return [vx, vy, dvxdt, dvydt]


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞–¥–∏—É—Å–∞ –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞
def orbit_radius(I, U, n):
    B = mu_0 * n * I

    if B == 0:
        return

    return math.sqrt((m_electron * 2 * U)/(e_charge * (B ** 2)))


def simulate_and_plot(U, Ic, Rk, steps=1000, tmax=1e-6, stop_velocity=None):
    n = 100  # –ß–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã
    B = mu_0 * n * Ic  # –ú–∞–≥–Ω–∏—Ç–Ω–æ–µ –ø–æ–ª–µ –≤–Ω—É—Ç—Ä–∏ —Å–æ–ª–µ–Ω–æ–∏–¥–∞

    # –ù–∞—á–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
    x0 = Rk
    y0 = 0
    v0 = np.sqrt(2 * e_charge * U / m_electron)
    r_orbit = orbit_radius(Ic, U, n)  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–¥–∏—É—Å–∞ –æ—Ä–±–∏—Ç—ã

    # –£–≥–ª–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞
    omega = v0 / r_orbit

    # –í—Ä–µ–º–µ–Ω–Ω–æ–π –º–∞—Å—Å–∏–≤
    t = np.linspace(0, tmax, steps)

    # –†–µ—à–µ–Ω–∏–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π
    sol = odeint(electron_motion, [x0, y0, v0, 0], t, args=(U, B, m_electron, e_charge))

    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
    if stop_velocity is not None:
        idx = np.where(np.sqrt(sol[:, 2] ** 2 + sol[:, 3] ** 2) <= stop_velocity)[0]
        if len(idx) > 0:
            sol = sol[:idx[0] + 1]

    # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
    plt.figure(figsize=(8, 6))
    plt.plot(sol[:, 0], sol[:, 1])
    plt.xlabel('x')
    plt.ylabel('y')
    plt.title('–¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞')
    plt.gca().set_aspect('equal', adjustable='box')
    plt.grid(True)
    plt.show()

    return r_orbit


def find_required_current(Ra, Rk, n, U):
    r_orbit = (Ra - Rk) / 2  # –†–∞–¥–∏—É—Å –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏

    if (r_orbit * e_charge * n * mu_0) == 0:
        return

    Ic_required = (m_electron * math.sqrt(2 * (e_charge / m_electron) * U)) / (r_orbit * e_charge * n * mu_0)

    return Ic_required


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã (Ic –æ—Ç U) –∏ –æ—Ç–º–µ—Ç–∫–∏ –æ–±–ª–∞—Å—Ç–∏, –≥–¥–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk)
def plot_Ic_U_diagram_with_circle(Ra, Rk, n):
    U_values = np.linspace(0, 1000, 100)  # –î–∏–∞–ø–∞–∑–æ–Ω —Ä–∞–∑–Ω–æ—Å—Ç–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤

    # –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π —Å–∏–ª—ã —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ
    Ic_values = []

    for U in U_values:
        # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å–∏–ª—ã —Ç–æ–∫–∞ Ic, —á—Ç–æ–±—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–ª –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –¥–∏–∞–º–µ—Ç—Ä–æ–º (Ra-Rk)
        Ic_required = find_required_current(Ra, Rk, n, U)
        Ic_values.append(Ic_required)

    # –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫ —á–∏—Å–ª–æ–≤–æ–º—É —Ç–∏–ø—É
    Ic_values = np.array(Ic_values, dtype=np.float64)

    plt.figure(figsize=(8, 6))
    plt.plot(U_values, Ic_values, label='Ic', color='blue')

    plt.fill_between(U_values, Ic_values, color='red', alpha=0.3, label='–≠–ª–µ–∫—Ç—Ä–æ–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å (Ra-Rk)')

    plt.xlabel('–†–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ (U)')
    plt.ylabel('–°–∏–ª–∞ —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ (Ic)')
    plt.title('–î–∏–∞–≥—Ä–∞–º–º–∞ Ic –æ—Ç U')
    plt.grid(True)
    plt.legend()
    plt.show()


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
Ra = 0.01  # –†–∞–¥–∏—É—Å –∞–Ω–æ–¥–∞ –≤ –º–µ—Ç—Ä–∞—Ö
Rk = 0.005  # –†–∞–¥–∏—É—Å –∫–∞—Ç–æ–¥–∞ –≤ –º–µ—Ç—Ä–∞—Ö
U = 100  # –†–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤ –≤ –≤–æ–ª—å—Ç–∞—Ö
Ic = 1  # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–∞ –≤ —Å–æ–ª–µ–Ω–æ–∏–¥–µ
n = 100  # –ß–∏—Å–ª–æ –≤–∏—Ç–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –¥–ª–∏–Ω—ã

# –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
r_orbit = simulate_and_plot(U, Ic, Rk, stop_velocity=1e5)
print("–†–∞–¥–∏—É—Å –æ—Ä–±–∏—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–∞:", r_orbit)

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã Ic –æ—Ç U
plot_Ic_U_diagram_with_circle(Ra, Rk, n)
````

---